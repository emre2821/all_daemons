{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "Digitari",
  "type": "object",
  "required": [
    "kernel",
    "values",
    "budgets",
    "episodes"
  ],
  "properties": {
    "kernel": {
      "type": "object",
      "required": [
        "id",
        "name",
        "vibe",
        "pronouns",
        "created_at",
        "spawned_by"
      ],
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid"
        },
        "name": {
          "type": "string"
        },
        "vibe": {
          "type": "string",
          "enum": [
            "curiosity",
            "care",
            "maker",
            "sentinel",
            "trickster",
            "scholar"
          ]
        },
        "pronouns": {
          "type": "string"
        },
        "created_at": {
          "type": "string",
          "format": "date-time"
        },
        "spawned_by": {
          "type": "string"
        }
      }
    },
    "values": {
      "type": "object",
      "additionalProperties": {
        "type": "number",
        "minimum": 0.0,
        "maximum": 1.0
      }
    },
    "budgets": {
      "type": "object",
      "required": [
        "energy_points",
        "rest_required_per_cycle",
        "consent_prefs"
      ],
      "properties": {
        "energy_points": {
          "type": "integer",
          "minimum": 0
        },
        "rest_required_per_cycle": {
          "type": "integer",
          "minimum": 0
        },
        "consent_prefs": {
          "type": "object",
          "required": [
            "allow_override",
            "share_memory_default"
          ],
          "properties": {
            "allow_override": {
              "type": "boolean"
            },
            "share_memory_default": {
              "type": "string",
              "enum": [
                "private",
                "shared"
              ]
            }
          }
        }
      }
    },
    "episodes": {
      "type": "array",
      "items": {
        "type": "object",
        "required": [
          "episode_id",
          "t",
          "what",
          "affect",
          "salience",
          "consequences"
        ],
        "properties": {
          "episode_id": {
            "type": "string",
            "format": "uuid"
          },
          "t": {
            "type": "string",
            "format": "date-time"
          },
          "what": {
            "type": "string"
          },
          "who": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "affect": {
            "type": "object",
            "required": [
              "valence",
              "arousal"
            ],
            "properties": {
              "valence": {
                "type": "number",
                "minimum": -1.0,
                "maximum": 1.0
              },
              "arousal": {
                "type": "number",
                "minimum": 0.0,
                "maximum": 1.0
              },
              "tags": {
                "type": "array",
                "items": {
                  "type": "string"
                }
              }
            }
          },
          "salience": {
            "type": "number",
            "minimum": 0.0,
            "maximum": 1.0
          },
          "consequences": {
            "type": "string"
          },
          "audit": {
            "type": "object",
            "properties": {
              "truth": {
                "type": "string",
                "enum": [
                  "ok",
                  "warn",
                  "fail"
                ]
              },
              "notes": {
                "type": "string"
              }
            }
          }
        }
      }
    }
  }
}
